<!DOCTYPE html>
<html>
<head>
	<title>Airplane!</title>
	<style type="text/css">
		/* body{
			background-image: url('./img/ocean.jpg');
			width:100%;
			height:100%;
		} */
		#ocean{
			background-image: url('./img/ocean.jpg');
			width: 100%;
			height: 600px;
			display:inline-block;
			left: 0px;
			top: 0px;
			position:absolute;
		}
		.hero1{
			background-image: url('./img/player1.png');
			position:absolute;
			width: 70px;
			height: 75px;
			background-position: center;
		}
		.hero2{
			background-image: url('./img/player2.png');
			background-size: cover;
			background-repeat: no-repeat;
			background-position:center;
			position:absolute;
			width: 70px;
			height: 75px;
		}
		.enemy1{
			background-image: url('./img/enemy1.png');
			position: absolute;
			width: 70px;
			height: 75px;
		}
		.enemy2{
			background-image: url('./img/enemy2.png');
			background-repeat: no-repeat;
			background-position:center;
			background-size: cover;
			position: absolute;
			width: 70px;
			height: 75px;
			background-size:cover;
		}
	</style>

</head>
<body>

	<div id = 'ocean'>
		<div id = 'player'></div>
		<div id = 'enemies'></div>
	</div>

	<script type="text/javascript">
		function randomNumber(min, max){
			var temp = Math.round(Math.random() * max)
			if (temp < min){
				temp = min;
			};
			return temp;
		}

		var player = {
			lives: 0
		}
		var heroes = [];
		
		var enemies = [];

		function drawWorld(){
			var background_number = randomNumber(1,2);
			console.log(background_number);
			document.getElementById('ocean').style.backgroundImage = "url('./img/ocean" + background_number + ".jpg')";
		}

		function initEnemies(){
			var num_enemies = randomNumber(1,4);
			for (var i = 0; i < num_enemies; i++){
				enemies.push({
					name: "enemy" + (i + 1),
					type: "enemy" + randomNumber(1,2),
					x: i,
					y: 0,
					status: "fighting",
					move_size: .25 * randomNumber(.5,1.5)
				})
			}

			var output = "";
			for (var i = 0; i < enemies.length; i++){
				output += "<div id = " + enemies[i].name + " class = " + enemies[i].type + "></div>";
				document.getElementById('enemies').innerHTML += output;
				output = "";
			}
		}

		function initPlayer(){
			player.lives = 3;
			heroes.push({
				name: 'hero1',
				type: 'hero2',
				x: 0,
				y: 0
			});
			document.getElementById('player').innerHTML = "<div id = 'hero1' class = " + heroes[0].type + "></div>";
		}

		function drawEnemies(){
			if (enemies.length > 0){
				for (var i = 0; i < enemies.length; i++){
					document.getElementById('enemy' + (i+1)).style.left = (enemies[i].x * 70) + "px";
					document.getElementById('enemy' + (i+1)).style.top = (enemies[i].y * 75) + "px";
				}
			}
		}

		function drawHeroes(){
			for (var i = 0; i < heroes.length; i++){
				document.getElementById('hero' + (i+1)).style.left = (heroes[i].x * 70) + "px";
				document.getElementById('hero' + (i+1)).style.top = (500 - (heroes[i].y * 75)) + "px";
			}
		}

		function moveEnemies(){
			for (var i = 0; i < enemies.length; i++){
				// enemies[i].y += enemies[i].move_size;
				enemies[i].y += enemies[i].move_size;
				if (enemies[i].y >= (500/70)){
					enemies[i].status = "destroyed";
					document.getElementById(enemies[i].name).remove();
				}
			}

			var replacement_array = [];
			for (var i = 0; i < enemies.length; i++){
				if (enemies[i].status == "fighting"){
					replacement_array.push(enemies[i]);
				}
			}
			enemies = replacement_array;
			console.log(enemies);
		}

		document.onkeydown = function(e){
			// make the ninja walk
			var moveDict = {
				37: 'left',
				38: 'up',
				39: 'right',
				40: 'down'
			};

			var move_size_x = .25;
			var move_size_y = .25;
			var dir = moveDict[e.keyCode];
			console.log(dir);
			
			if (dir == 'left' || dir == 'right' || dir == 'up' || dir == 'down'){e.preventDefault();}
			if (dir == 'left'){
				if (heroes[0].x != 0){
					for (var i = 0; i < heroes.length; i++){
						heroes[i].x -= move_size_x;
					}
				}
			} else if (dir == 'right'){
				if (heroes[heroes.length - 1].x != Math.floor((screen.width) / 75)){
					for (var i = 0; i < heroes.length; i++){
						heroes[i].x += move_size_x;
					}
				}
			} else if (dir == 'up'){
				if (heroes[0].y != (Math.floor((500 / 3) / 75))){
					for (var i = 0; i < heroes.length; i++){
						heroes[i].y += move_size_y;
					}
				}
			} else if (dir == 'down'){
				if (heroes[0].y != 0){
					for (var i = 0; i < heroes.length; i++){
						heroes[i].y -= move_size_y;
					}
				}
			}

			drawHeroes();
			console.log(heroes[0]);
		}

		function gameLoop(){
			moveEnemies();
			drawEnemies();
			setTimeout(gameLoop, 1000);
		}

		drawWorld();
		initEnemies();
		initPlayer();
		drawHeroes();
		drawEnemies();
		gameLoop();
	</script>	
</body>
</html>